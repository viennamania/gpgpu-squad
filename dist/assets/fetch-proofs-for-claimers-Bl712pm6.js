const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DillEupA.js","assets/index-DUMAu9QS.css","assets/decimals-3CvhMhix.js","assets/decimals-BMFRIXpg.js"])))=>i.map(i=>d[i]);
import{bb as N,bc as P,b as O,I as H,S as g,bd as q,be as v,bf as z,bg as j,bh as M,bi as F,bj as V,bk as B,bl as $,bm as J,a0 as d,r as W,Z as _,u as p,bn as Z,bo as A,bp as Q,bq as G,br as K,bs as X,bt as f,bu as E,bv as k}from"./index-DillEupA.js";import{n as Y,s as tt}from"./symbol-Dt5V4orv.js";function et(r,t){if(r.length!==t.length)throw new N({expectedLength:r.length,givenLength:t.length});const e=[];for(let a=0;a<r.length;a++){const n=r[a],i=t[a];e.push(T(n,i))}return P(e)}function T(r,t,e=!1){if(r==="address"){const s=t;if(!O(s))throw new H({address:s});return g(s.toLowerCase(),{size:e?32:null})}if(r==="string")return q(t);if(r==="bytes")return t;if(r==="bool")return g(v(t),{size:e?32:1});const a=r.match(z);if(a){const[s,c,o="256"]=a,l=Number.parseInt(o)/8;return j(t,{size:e?32:l,signed:c==="int"})}const n=r.match(M);if(n){const[s,c]=n;if(Number.parseInt(c)!==(t.length-2)/2)throw new F({expectedSize:Number.parseInt(c),givenSize:(t.length-2)/2});return g(t,{dir:"right",size:e?32:null})}const i=r.match(V);if(i&&Array.isArray(t)){const[s,c]=i,o=[];for(let l=0;l<t.length;l++)o.push(T(c,t[l],!0));return o.length===0?"0x":P(o)}throw new B(r)}async function rt(r){const{client:t,uri:e}=r;if($(e))try{return JSON.parse(J(e))}catch(n){console.error("Failed to decode base64 encoded contract metadata",{uri:e},n);return}const{download:a}=await d(async()=>{const{download:n}=await import("./index-DillEupA.js").then(i=>i.dS);return{download:n}},__vite__mapDeps([0,1]));return await(await a({client:t,uri:e})).json()}const nt="0xe8a3d485",at=[],st=[{type:"string"}];async function it(r){return W({contract:r.contract,method:[nt,at,st],params:[]})}async function ct(r){const[t,e,a]=await Promise.all([it(r).then(n=>n?rt({client:r.contract.client,uri:n}):null).catch(()=>null),Y(r).catch(()=>null),tt(r).catch(()=>null)]);return{...t,name:(t==null?void 0:t.name)??e,symbol:(t==null?void 0:t.symbol)??a}}class ot{constructor(t){Object.defineProperty(this,"leaves",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.leaves=t.map(e=>e instanceof Uint8Array?e:_(e)),this.leaves=this.leaves.sort(),this.createHashes(this.leaves)}getHexRoot(){return p(this.getRoot())}getHexProof(t,e){return this.getProof(t,e).map(a=>p(a.data))}createHashes(t){for(this.layers=[t];t.length>1;){const e=this.layers.length;this.layers.push([]);const a=t.length;for(let n=0;n<t.length;n+=2){if(n>=a){this.layers[e].push(...t.slice(a));break}if(n+1===t.length&&t.length%2===1){this.layers[e].push(t[n]);continue}const i=t[n],s=n+1===t.length?i:t[n+1],c=[i,s];c.sort(Z);const o=A(Q(c),"bytes");this.layers[e].push(o)}t=this.layers[e]}}getRoot(){return this.layers.length===0?new Uint8Array:this.layers[this.layers.length-1][0]||new Uint8Array}getProof(t,e){if(typeof t>"u")throw new Error("leaf is required");t=t instanceof Uint8Array?t:_(t);const a=[];if(!Number.isInteger(e)){e=-1;for(let n=0;n<this.leaves.length;n++)G(t,this.leaves[n])&&(e=n)}if(e<=-1)return[];for(let n=0;n<this.layers.length;n++){const i=this.layers[n],s=e%2,c=s?e-1:e+1;c<i.length&&a.push({position:s?"left":"right",data:i[c]}),e=e/2|0}return a}}function b(r){const{quantity:t,tokenDecimals:e}=r;return t==="unlimited"?K:X(t,e)}async function D(r){const t=r.entry.currencyAddress||f,e=await(async()=>{if(E(t)||t===f)return 18;const[{getContract:a},{decimals:n}]=await Promise.all([d(()=>import("./index-DillEupA.js").then(s=>s.dM),__vite__mapDeps([0,1])),d(()=>import("./decimals-3CvhMhix.js"),__vite__mapDeps([2,0,1,3]))]),i=a({address:t,chain:r.chain,client:r.client});return await n({contract:i})})();return A(et(["address","uint256","uint256","address"],[r.entry.address,b({quantity:r.entry.maxClaimable||"unlimited",tokenDecimals:r.tokenDecimals}),b({quantity:r.entry.price||"unlimited",tokenDecimals:e}),t]))}async function ut(r){const{contract:t,merkleRoot:e,claimer:a}=r,s=((await ct({contract:t})).merkle||{})[e];if(!s)return null;const o=await(await k({client:t.client,uri:s})).json(),l=a.slice(2,2+o.shardNybbles).toLowerCase(),U=o.baseUri.endsWith("/")?o.baseUri:`${o.baseUri}/`;let m;try{const h=`${U}${l}.json`;m=await(await k({client:t.client,uri:h})).json()}catch{return null}const I=await Promise.all(m.entries.map(async h=>D({entry:h,chain:t.chain,client:t.client,tokenDecimals:r.tokenDecimals}))),R=new ot(I),u=m.entries.find(h=>h.address.toLowerCase()===a.toLowerCase());if(!u)return null;const C=R.getHexProof(await D({entry:u,chain:t.chain,client:t.client,tokenDecimals:r.tokenDecimals})).concat(m.proofs),y=u.currencyAddress||f,L=await(async()=>{if(E(y)||y===f)return 18;const[{getContract:h},{decimals:w}]=await Promise.all([d(()=>import("./index-DillEupA.js").then(x=>x.dM),__vite__mapDeps([0,1])),d(()=>import("./decimals-3CvhMhix.js"),__vite__mapDeps([2,0,1,3]))]),S=h({address:y,chain:t.chain,client:t.client});return await w({contract:S})})();return{proof:C,quantityLimitPerWallet:b({quantity:u.maxClaimable||"unlimited",tokenDecimals:r.tokenDecimals}),pricePerToken:b({quantity:u.price||"unlimited",tokenDecimals:L}),currency:y}}export{ut as fetchProofsForClaimer};
