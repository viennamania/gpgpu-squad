import{s as b,d as E,g as k}from"./BuyScreen-CAT6Bk9i.js";import"./index-DillEupA.js";import"./approve-WRg-TvlM.js";import"./useShowMore-EXbiKoIL.js";import"./formElements-D8X8dk3w.js";import"./InputSelectionUI-D5yAzt1Q.js";import"./index-DbFviogd.js";import"./types-CKeVp00v.js";import"./types-YMLL-Nyu.js";import"./getNFT-DSpJhR8N.js";import"./arweave-CAGvOb64.js";import"./___vite-browser-external_commonjs-proxy-CQ4WIAjb.js";import"./index-b5uzGJBT.js";import"./inherits_browser-BlmhoU4v.js";import"./constants-wPy4vL4v.js";import"./client-scoped-storage-ChRDBjxy.js";import"./decimals-3CvhMhix.js";import"./decimals-BMFRIXpg.js";import"./getCurrencyMetadata-A66ufPbR.js";import"./symbol-Dt5V4orv.js";async function Z(t){var r,p;const{wallet:a,walletConnectClient:e,event:i,chains:s,onConnect:c}=t,d=a.getAccount();if(!d)throw new Error("No account connected to provided wallet");const n=(p=(r=i.verifyContext)==null?void 0:r.verified)==null?void 0:p.origin;n&&await A({origin:n,walletConnectClient:e});const o=await W({account:d,walletConnectClient:e,sessionProposal:i,chains:s});await b(o),a.subscribe("disconnect",()=>{E({session:o,walletConnectClient:e})}),c==null||c(o)}async function A({walletConnectClient:t,origin:a}){const e=await k();for(const i of e)i.origin===a&&await E({session:i,walletConnectClient:t})}async function W({account:t,walletConnectClient:a,sessionProposal:e,chains:i}){var n,o,r,p,w,f,v,l,u,g,N,h,S,y,$,C,q,x;if(!((n=e.params.requiredNamespaces)!=null&&n.eip155)&&!((o=e.params.optionalNamespaces)!=null&&o.eip155))throw new Error("No EIP155 namespace found in Wallet Connect session proposal");const s={chains:[...Array.from(new Set([...((w=(p=(r=e.params.requiredNamespaces)==null?void 0:r.eip155)==null?void 0:p.chains)==null?void 0:w.map(m=>`${m}:${t.address}`))??[],...((l=(v=(f=e.params.optionalNamespaces)==null?void 0:f.eip155)==null?void 0:v.chains)==null?void 0:l.map(m=>`${m}:${t.address}`))??[],...(i==null?void 0:i.map(m=>`eip155:${m.id}:${t.address}`))??[]]))],methods:[...((g=(u=e.params.requiredNamespaces)==null?void 0:u.eip155)==null?void 0:g.methods)??[],...((h=(N=e.params.optionalNamespaces)==null?void 0:N.eip155)==null?void 0:h.methods)??[]],events:[...((y=(S=e.params.requiredNamespaces)==null?void 0:S.eip155)==null?void 0:y.events)??[],...((C=($=e.params.optionalNamespaces)==null?void 0:$.eip155)==null?void 0:C.events)??[]]};return{topic:(await(await a.approve({id:e.id,namespaces:{eip155:{accounts:s.chains,methods:s.methods,events:s.events}}})).acknowledged()).topic,origin:((x=(q=e.verifyContext)==null?void 0:q.verified)==null?void 0:x.origin)||"Unknown origin"}}export{W as acceptSessionProposal,A as disconnectExistingSessions,Z as onSessionProposal};
