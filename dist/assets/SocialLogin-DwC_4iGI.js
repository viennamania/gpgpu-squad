import{aV as ce,aW as Ve,at as r,aq as e,av as p,aX as Ue,aR as ue,aY as Te,aK as qe,aU as Ge,aZ as ae,aw as ye,aA as g,aO as M,aL as le,a_ as Q,a$ as Ye,b0 as Ke,b1 as ne,ak as re,b2 as Qe,ay as de,as as Xe}from"./index-DillEupA.js";import{l as ie}from"./InputSelectionUI-D5yAzt1Q.js";import{preAuthenticate as Pe}from"./index-C5TfYiZ5.js";import{hasStoredPasskey as Je}from"./passkeys-B4oNeLJB.js";import{l as Ze}from"./oauth-zvjgX-c5.js";import{o as et}from"./useInAppWalletLocale-CX9ZgvzM.js";const pe=ce({animation:`${Ve} 0.15s ease-in`});var tt=Object.defineProperty,nt=Object.defineProperties,rt=Object.getOwnPropertyDescriptors,se=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable,Me=(t,n,i)=>n in t?tt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i,it=(t,n)=>{for(var i in n||(n={}))Ie.call(n,i)&&Me(t,i,n[i]);if(se)for(var i of se(n))Ae.call(n,i)&&Me(t,i,n[i]);return t},ot=(t,n)=>nt(t,rt(n)),at=(t,n)=>{var i={};for(var d in t)Ie.call(t,d)&&n.indexOf(d)<0&&(i[d]=t[d]);if(t!=null&&se)for(var d of se(t))n.indexOf(d)<0&&Ae.call(t,d)&&(i[d]=t[d]);return i},lt="^\\d+$";function st(t){let n=setTimeout(t,0),i=setTimeout(t,10),d=setTimeout(t,50);return[n,i,d]}function ct(t){let n=r.useRef();return r.useEffect(()=>{n.current=t}),n.current}var ut=18,We=40,dt=`${We}px`,ht=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function gt({containerRef:t,inputRef:n,pushPasswordManagerStrategy:i,isFocused:d}){let u=r.useRef({done:!1,refocused:!1}),[s,y]=r.useState(!1),[h,k]=r.useState(!1),[f,j]=r.useState(!1),b=r.useMemo(()=>i==="none"?!1:(i==="increase-width"||i==="experimental-no-flickering")&&s&&h,[s,h,i]),T=r.useCallback(()=>{let w=t.current,l=n.current;if(!w||!l||f||i==="none")return;let c=w,L=c.getBoundingClientRect().left+c.offsetWidth,P=c.getBoundingClientRect().top+c.offsetHeight/2,R=L-ut,B=P;if(!(document.querySelectorAll(ht).length===0&&document.elementFromPoint(R,B)===w)&&(y(!0),j(!0),!u.current.refocused&&document.activeElement===l)){let A=[l.selectionStart,l.selectionEnd];l.blur(),l.focus(),l.setSelectionRange(A[0],A[1]),u.current.refocused=!0}},[t,n,f,i]);return r.useEffect(()=>{let w=t.current;if(!w||i==="none")return;function l(){let L=window.innerWidth-w.getBoundingClientRect().right;k(L>=We)}l();let c=setInterval(l,1e3);return()=>{clearInterval(c)}},[t,i]),r.useEffect(()=>{let w=d||document.activeElement===n.current;if(i==="none"||!w)return;let l=setTimeout(T,0),c=setTimeout(T,2e3),L=setTimeout(T,5e3),P=setTimeout(()=>{j(!0)},6e3);return()=>{clearTimeout(l),clearTimeout(c),clearTimeout(L),clearTimeout(P)}},[n,d,i,T]),{hasPWMBadge:s,willPushPWMBadge:b,PWM_BADGE_SPACE_WIDTH:dt}}var xt=r.createContext({}),Oe=r.forwardRef((t,n)=>{var i=t,{value:d,onChange:u,maxLength:s,textAlign:y="left",pattern:h=lt,inputMode:k="numeric",onComplete:f,pushPasswordManagerStrategy:j="increase-width",containerClassName:b,noScriptCSSFallback:T=ft,render:w,children:l}=i,c=at(i,["value","onChange","maxLength","textAlign","pattern","inputMode","onComplete","pushPasswordManagerStrategy","containerClassName","noScriptCSSFallback","render","children"]),L,P,R,B,A;let[H,m]=r.useState(typeof c.defaultValue=="string"?c.defaultValue:""),x=d??H,S=ct(x),X=r.useCallback(o=>{u==null||u(o),m(o)},[u]),O=r.useMemo(()=>h?typeof h=="string"?new RegExp(h):h:null,[h]),C=r.useRef(null),he=r.useRef(null),ge=r.useRef({value:x,onChange:X,isIOS:typeof window<"u"&&((P=(L=window==null?void 0:window.CSS)==null?void 0:L.supports)==null?void 0:P.call(L,"-webkit-touch-callout","none"))}),oe=r.useRef({prev:[(R=C.current)==null?void 0:R.selectionStart,(B=C.current)==null?void 0:B.selectionEnd,(A=C.current)==null?void 0:A.selectionDirection]});r.useImperativeHandle(n,()=>C.current,[]),r.useEffect(()=>{let o=C.current,a=he.current;if(!o||!a)return;ge.current.value!==o.value&&ge.current.onChange(o.value),oe.current.prev=[o.selectionStart,o.selectionEnd,o.selectionDirection];function E(){if(document.activeElement!==o){Z(null),ee(null);return}let v=o.selectionStart,W=o.selectionEnd,_=o.selectionDirection,N=o.maxLength,V=o.value,K=oe.current.prev,D=-1,F=-1,U;if(V.length!==0&&v!==null&&W!==null){let He=v===W,$e=v===V.length&&V.length<N;if(He&&!$e){let q=v;if(q===0)D=0,F=1,U="forward";else if(q===N)D=q-1,F=q,U="backward";else if(N>1&&V.length>1){let me=0;if(K[0]!==null&&K[1]!==null){U=q<K[1]?"backward":"forward";let Ne=K[0]===K[1]&&K[0]<N;U==="backward"&&!Ne&&(me=-1)}D=me+q,F=me+q+1}}D!==-1&&F!==-1&&D!==F&&C.current.setSelectionRange(D,F,U)}let Ee=D!==-1?D:v,Le=F!==-1?F:W,Fe=U??_;Z(Ee),ee(Le),oe.current.prev=[Ee,Le,Fe]}if(document.addEventListener("selectionchange",E,{capture:!0}),E(),document.activeElement===o&&xe(!0),!document.getElementById("input-otp-style")){let v=document.createElement("style");if(v.id="input-otp-style",document.head.appendChild(v),v.sheet){let W="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";te(v.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),te(v.sheet,`[data-input-otp]:autofill { ${W} }`),te(v.sheet,`[data-input-otp]:-webkit-autofill { ${W} }`),te(v.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),te(v.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let I=()=>{a&&a.style.setProperty("--root-height",`${o.clientHeight}px`)};I();let z=new ResizeObserver(I);return z.observe(o),()=>{document.removeEventListener("selectionchange",E,{capture:!0}),z.disconnect()}},[]);let[ve,ke]=r.useState(!1),[J,xe]=r.useState(!1),[$,Z]=r.useState(null),[G,ee]=r.useState(null);r.useEffect(()=>{st(()=>{var o,a,E,I;(o=C.current)==null||o.dispatchEvent(new Event("input"));let z=(a=C.current)==null?void 0:a.selectionStart,v=(E=C.current)==null?void 0:E.selectionEnd,W=(I=C.current)==null?void 0:I.selectionDirection;z!==null&&v!==null&&(Z(z),ee(v),oe.current.prev=[z,v,W])})},[x,J]),r.useEffect(()=>{S!==void 0&&x!==S&&S.length<s&&x.length===s&&(f==null||f(x))},[s,f,S,x]);let Y=gt({containerRef:he,inputRef:C,pushPasswordManagerStrategy:j,isFocused:J}),we=r.useCallback(o=>{let a=o.currentTarget.value.slice(0,s);if(a.length>0&&O&&!O.test(a)){o.preventDefault();return}typeof S=="string"&&a.length<S.length&&document.dispatchEvent(new Event("selectionchange")),X(a)},[s,X,S,O]),Se=r.useCallback(()=>{var o;if(C.current){let a=Math.min(C.current.value.length,s-1),E=C.current.value.length;(o=C.current)==null||o.setSelectionRange(a,E),Z(a),ee(E)}xe(!0)},[s]),Ce=r.useCallback(o=>{var a,E;let I=C.current;if(!ge.current.isIOS||!o.clipboardData||!I)return;let z=o.clipboardData.getData("text/plain");o.preventDefault();let v=(a=C.current)==null?void 0:a.selectionStart,W=(E=C.current)==null?void 0:E.selectionEnd,_=(v!==W?x.slice(0,v)+z+x.slice(W):x.slice(0,v)+z+x.slice(v)).slice(0,s);if(_.length>0&&O&&!O.test(_))return;I.value=_,X(_);let N=Math.min(_.length,s-1),V=_.length;I.setSelectionRange(N,V),Z(N),ee(V)},[s,X,O,x]),ze=r.useMemo(()=>({position:"relative",cursor:c.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[c.disabled]),be=r.useMemo(()=>({position:"absolute",inset:0,width:Y.willPushPWMBadge?`calc(100% + ${Y.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:Y.willPushPWMBadge?`inset(0 ${Y.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:y,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[Y.PWM_BADGE_SPACE_WIDTH,Y.willPushPWMBadge,y]),_e=r.useMemo(()=>r.createElement("input",ot(it({autoComplete:c.autoComplete||"one-time-code"},c),{"data-input-otp":!0,"data-input-otp-mss":$,"data-input-otp-mse":G,inputMode:k,pattern:O==null?void 0:O.source,style:be,maxLength:s,value:x,ref:C,onPaste:o=>{var a;Ce(o),(a=c.onPaste)==null||a.call(c,o)},onChange:we,onMouseOver:o=>{var a;ke(!0),(a=c.onMouseOver)==null||a.call(c,o)},onMouseLeave:o=>{var a;ke(!1),(a=c.onMouseLeave)==null||a.call(c,o)},onFocus:o=>{var a;Se(),(a=c.onFocus)==null||a.call(c,o)},onBlur:o=>{var a;xe(!1),(a=c.onBlur)==null||a.call(c,o)}})),[we,Se,Ce,k,be,s,G,$,c,O==null?void 0:O.source,x]),fe=r.useMemo(()=>({slots:Array.from({length:s}).map((o,a)=>{let E=J&&$!==null&&G!==null&&($===G&&a===$||a>=$&&a<G),I=x[a]!==void 0?x[a]:null;return{char:I,isActive:E,hasFakeCaret:E&&I===null}}),isFocused:J,isHovering:!c.disabled&&ve}),[J,ve,s,G,$,c.disabled,x]),De=r.useMemo(()=>w?w(fe):r.createElement(xt.Provider,{value:fe},l),[l,fe,w]);return r.createElement(r.Fragment,null,T!==null&&r.createElement("noscript",null,r.createElement("style",null,T)),r.createElement("div",{ref:he,"data-input-otp-container":!0,style:ze,className:b},De,r.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},_e)))});Oe.displayName="Input";function te(t,n){try{t.insertRule(n)}catch{console.error("input-otp could not insert CSS rule:",n)}}var ft=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;function mt(t){return e.jsx(pt,{children:e.jsx(Oe,{onComplete:()=>{t.onEnter()},maxLength:6,value:t.value,render:({slots:n})=>e.jsx(p,{flex:"row",gap:"xs",center:"both",children:n.map((i,d)=>e.jsx(yt,{...i,isInvalid:t.isInvalid},d))}),onChange:n=>{t.setValue(n)}})})}const pt=ce({"& input":{maxWidth:"100%"}});function yt(t){return e.jsxs(kt,{"data-active":t.isActive,"data-error":t.isInvalid,children:[t.char!==null&&e.jsx("div",{children:t.char}),t.hasFakeCaret&&e.jsx(vt,{})]})}const jt=Ue`
  0%, 100% {
    opacity: 0;
  },
  50% {
    opacity: 1;
  }
  `,vt=ce(t=>{const n=ue();return{position:"absolute",pointerEvents:"none",inset:0,display:"flex",alignItems:"center",justifyContent:"center",animation:`${jt} 1s infinite`,"&::before":{content:"''",display:"block",width:"1.5px",height:"1em",backgroundColor:n.colors.primaryText}}}),kt=ce(t=>{const n=ue();return{position:"relative",width:"40px",height:"40px",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",fontSize:Te.md,padding:qe.xs,boxSizing:"border-box",transition:"color 200ms ease",border:`2px solid ${n.colors.borderColor}`,"&[data-active='true']":{borderColor:n.colors.accentText},color:n.colors.primaryText,borderRadius:Ge.lg,"&[data-error='true']":{borderColor:n.colors.danger}}});function At(t){const{wallet:n,done:i,goBack:d,userInfo:u}=t,s=t.size==="wide",y=t.locale,[h,k]=r.useState(""),[f,j]=r.useState("idle"),[b,T]=r.useState(),[w,l]=r.useState("sending"),c=r.useMemo(()=>ae(n.id),[n.id]),[L]=r.useState("base"),P=r.useCallback(async()=>{var m,x;k(""),j("idle"),l("sending");try{if("email"in u)await Pe({ecosystem:c?{id:n.id,partnerId:(m=n.getConfig())==null?void 0:m.partnerId}:void 0,email:u.email,strategy:"email",client:t.client}),l("sent");else if("phone"in u)await Pe({ecosystem:c?{id:n.id,partnerId:(x=n.getConfig())==null?void 0:x.partnerId}:void 0,phoneNumber:u.phone,strategy:"phone",client:t.client}),l("sent");else throw new Error("Invalid userInfo")}catch(S){console.error(S),j("idle"),l("error")}},[t.client,u,n,c]);async function R(m){if("email"in u)await n.connect({chain:t.chain,strategy:"email",email:u.email,verificationCode:m,client:t.client}),await ne("email",re);else if("phone"in u)await n.connect({chain:t.chain,strategy:"phone",phoneNumber:u.phone,verificationCode:m,client:t.client}),await ne("phone",re);else throw new Error("Invalid userInfo")}async function B(m){"email"in u?await ie(n,{strategy:"email",email:u.email,verificationCode:m}):"phone"in u&&await ie(n,{strategy:"phone",phoneNumber:u.phone,verificationCode:m})}const A=async m=>{var x;if(m.length===6){j("verifying");try{t.isLinking?await B(m):await R(m),i(),j("valid")}catch(S){S instanceof Error&&((x=S==null?void 0:S.message)!=null&&x.includes("PAYMENT_METHOD_REQUIRED"))?j("payment_required"):S instanceof Error&&(S.message.toLowerCase().includes("link")||S.message.toLowerCase().includes("profile"))?(j("linking_error"),T(S.message)):j("invalid"),console.error("Authentication Error",S)}}},H=r.useRef(!1);return r.useEffect(()=>{H.current||(H.current=!0,P())},[P]),L==="base"?e.jsxs(p,{fullHeight:!0,flex:"column",animate:"fadein",children:[e.jsx(p,{p:"lg",children:e.jsx(ye,{title:y.signIn,onBack:d})}),e.jsx(p,{expand:!0,flex:"column",center:"y",children:e.jsxs("form",{onSubmit:m=>{m.preventDefault()},children:[e.jsxs(p,{flex:"column",center:"x",px:"lg",children:[!s&&e.jsx(g,{y:"xl"}),e.jsx(M,{children:y.emailLoginScreen.enterCodeSendTo}),e.jsx(g,{y:"sm"}),e.jsx(M,{color:"primaryText",children:"email"in u?u.email:u.phone}),e.jsx(g,{y:"xl"})]}),e.jsx(mt,{isInvalid:f==="invalid",digits:6,value:h,setValue:m=>{k(m),j("idle")},onEnter:()=>{A(h)}}),f==="invalid"&&e.jsxs(pe,{children:[e.jsx(g,{y:"md"}),e.jsx(M,{size:"sm",color:"danger",center:!0,children:y.emailLoginScreen.invalidCode})]}),f==="linking_error"&&e.jsxs(pe,{children:[e.jsx(g,{y:"md"}),e.jsx(M,{size:"sm",color:"danger",center:!0,children:b||"Failed to verify code"})]}),f==="payment_required"&&e.jsxs(pe,{children:[e.jsx(g,{y:"md"}),e.jsx(M,{size:"sm",color:"danger",center:!0,children:y.maxAccountsExceeded})]}),e.jsx(g,{y:"xl"}),e.jsx(p,{px:s?"xxl":"lg",children:f==="verifying"?e.jsx(e.Fragment,{children:e.jsx(p,{flex:"row",center:"x",animate:"fadein",children:e.jsx(le,{size:"lg",color:"accentText"})})}):e.jsx(p,{animate:"fadein",children:e.jsx(Q,{onClick:()=>A(h),variant:"accent",type:"submit",style:{width:"100%"},children:y.emailLoginScreen.verify})},"btn-container")}),e.jsx(g,{y:"xl"}),!s&&e.jsx(Ye,{}),e.jsxs(p,{p:s?void 0:"lg",children:[w==="error"&&e.jsx(e.Fragment,{children:e.jsx(M,{size:"sm",center:!0,color:"danger",children:y.emailLoginScreen.failedToSendCode})}),w==="sending"&&e.jsxs(p,{flex:"row",center:"both",gap:"xs",style:{textAlign:"center"},children:[e.jsx(M,{size:"sm",children:y.emailLoginScreen.sendingCode}),e.jsx(le,{size:"xs",color:"secondaryText"})]}),w==="sent"&&e.jsx(wt,{onClick:P,type:"button",children:y.emailLoginScreen.resendCode})]})]})})]}):null}const wt=Ke(t=>{const n=ue();return{all:"unset",color:n.colors.accentText,fontSize:Te.sm,cursor:"pointer",textAlign:"center",fontWeight:500,width:"100%","&:hover":{color:n.colors.primaryText}}}),je=t=>e.jsxs("svg",{width:t.size,height:t.size,viewBox:"0 0 36 36",fill:"none","aria-hidden":"true",children:[e.jsx("path",{d:"M18.0001 15C17.2045 15 16.4414 15.3161 15.8788 15.8787C15.3162 16.4413 15.0001 17.2044 15.0001 18C15.0001 19.53 14.8501 21.765 14.6101 24",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21.0002 19.6801C21.0002 23.2501 21.0002 29.2501 19.5002 33.0001",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M25.9348 31.53C26.1148 30.63 26.5798 28.08 26.6848 27",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2.99976 18C2.99976 14.8518 3.99032 11.7833 5.83112 9.22935C7.67193 6.67536 10.2697 4.76531 13.2563 3.76975C16.243 2.77419 19.4672 2.74359 22.4723 3.6823C25.4773 4.621 28.1108 6.48141 29.9998 9",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2.99976 24H3.01628",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M32.7 24C33 21 32.8965 15.969 32.7 15",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M7.49976 29.25C8.24976 27 8.99976 22.5 8.99976 18C8.99824 16.9783 9.17071 15.9638 9.50976 15",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12.9751 33C13.2901 32.01 13.6501 31.02 13.8301 30",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M13.5 10.2C14.8686 9.40988 16.4211 8.99401 18.0014 8.99426C19.5818 8.99452 21.1342 9.41088 22.5025 10.2015C23.8708 10.9921 25.0069 12.129 25.7964 13.498C26.5859 14.867 27.001 16.4197 27 18V21",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})]});function Re(t){return e.jsxs(p,{animate:"fadein",children:[e.jsx(g,{y:"xxl"}),e.jsx(p,{flex:"row",center:"x",children:e.jsx(Qe,{size:de["3xl"]})}),e.jsx(g,{y:"lg"}),e.jsx(M,{center:!0,color:"primaryText",size:"md",children:t.title}),e.jsx(g,{y:"xl"}),e.jsx(g,{y:"xxl"}),e.jsx(Q,{variant:"accent",fullWidth:!0,onClick:t.onTryAgain,children:"Try Again"})]})}function Be(t){return e.jsxs(p,{animate:"fadein",children:[e.jsx(g,{y:"xxl"}),e.jsxs(p,{flex:"row",center:"x",style:{position:"relative"},children:[e.jsx(le,{size:"4xl",color:"accentText"}),e.jsx(p,{color:"accentText",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:t.icon})]}),e.jsx(g,{y:"xl"}),e.jsx(M,{center:!0,color:"primaryText",size:"lg",children:t.title}),e.jsx(g,{y:"md"}),e.jsx(M,{multiline:!0,center:!0,children:t.subtitle}),e.jsx(g,{y:"xxl"}),e.jsx(g,{y:"xxl"})]})}function Wt(t){const{wallet:n,done:i,client:d,chain:u,size:s,locale:y}=t,[h,k]=r.useState("loading"),f=r.useRef(!1);return r.useEffect(()=>{f.current||(f.current=!0,Je(d,ae(n.id)?n.id:void 0).then(j=>{k(j?"login":"select")}).catch(()=>{k("select")}))},[d,n.id]),e.jsxs(p,{animate:"fadein",fullHeight:!0,flex:"column",children:[e.jsx(p,{p:"lg",children:e.jsx(ye,{title:t.isLinking?y.passkeys.linkPasskey:y.passkeys.title,onBack:t.onBack})}),e.jsx(p,{px:s==="wide"?"xxl":"lg",expand:!0,flex:"column",center:"y",children:e.jsxs("div",{children:[h==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx(Xe,{}),e.jsx(g,{y:"xxl"})]}),h==="select"&&e.jsx(bt,{onSignin:()=>{k("login")},onSignup:()=>{k("signup")}}),h==="login"&&e.jsx(St,{wallet:n,client:d,done:i,onCreate:()=>{k("signup")},chain:u,isLinking:t.isLinking}),h==="signup"&&e.jsx(Ct,{wallet:n,client:d,done:i,chain:u,isLinking:t.isLinking})]})})]})}function St(t){const{wallet:n,done:i,client:d,chain:u}=t,[s,y]=r.useState("loading"),[h,k]=r.useState();async function f(){y("loading");try{t.isLinking?await ie(n,{strategy:"passkey",type:"sign-in"}).catch(b=>{throw k(b.message),b}):(await n.connect({client:d,strategy:"passkey",type:"sign-in",chain:u}),await ne("passkey",re)),i()}catch{y("error")}}const j=r.useRef(!1);return r.useEffect(()=>{j.current||(j.current=!0,f())}),s==="loading"?e.jsx(Be,{title:"Requesting Passkey",subtitle:"A pop-up prompt will appear to sign-in and verify your passkey",icon:e.jsx(je,{size:de.xxl})}):s==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Re,{onTryAgain:f,title:h||"Failed to Login"}),e.jsx(g,{y:"sm"}),e.jsx(Q,{variant:"outline",fullWidth:!0,onClick:t.onCreate,children:"Create a new Passkey"}),e.jsx(g,{y:"lg"})]}):null}function Ct(t){const{wallet:n,done:i,client:d,chain:u}=t,[s,y]=r.useState(),[h,k]=r.useState("loading");async function f(){k("loading");try{t.isLinking?await ie(n,{strategy:"passkey",type:"sign-up"}):(await n.connect({client:d,strategy:"passkey",type:"sign-up",chain:u}),await ne("passkey",re)),i()}catch(b){console.error(b),b instanceof Error&&y(`Error creating passkey: ${b.message}`),k("error")}}const j=r.useRef(!1);return r.useEffect(()=>{j.current||(j.current=!0,f())}),h==="loading"?e.jsx(Be,{title:"Creating Passkey",subtitle:"A pop-up prompt will appear to sign-in and verify your passkey",icon:e.jsx(je,{size:de.xxl})}):h==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Re,{onTryAgain:f,title:s||"Failed to create passkey"}),e.jsx(g,{y:"lg"})]}):null}function bt(t){return e.jsxs(p,{children:[e.jsx(g,{y:"xxl"}),e.jsx(p,{flex:"row",center:"x",color:"accentText",children:e.jsx(je,{size:de["4xl"]})}),e.jsx(g,{y:"xl"}),e.jsx(g,{y:"xxl"}),e.jsx(Q,{variant:"accent",onClick:t.onSignup,fullWidth:!0,children:"Create a Passkey"}),e.jsx(g,{y:"sm"}),e.jsx(Q,{variant:"outline",onClick:t.onSignin,fullWidth:!0,children:"I have a Passkey"}),e.jsx(g,{y:"lg"})]})}function Ot(t){var w;const n=t.locale,i=n.socialLoginScreen,d=ue(),[u,s]=r.useState(void 0),{done:y,wallet:h}=t,[k,f]=r.useState("connecting"),j=async()=>{var L,P,R,B,A,H;const l=h.getConfig(),c=l&&"auth"in l?((L=l==null?void 0:l.auth)==null?void 0:L.mode)??"popup":"popup";if(l&&"auth"in l&&c!=="popup"&&!t.isLinking)return Ze({authOption:t.socialAuth,client:t.client,ecosystem:ae(h)?{id:h.id,partnerId:(P=h.getConfig())==null?void 0:P.partnerId}:void 0,redirectUrl:(R=l==null?void 0:l.auth)==null?void 0:R.redirectUrl,mode:(B=l==null?void 0:l.auth)==null?void 0:B.mode});try{const m=et({authOption:t.socialAuth,themeObj:d,client:t.client,ecosystem:ae(h)?{id:h.id,partnerId:(A=h.getConfig())==null?void 0:A.partnerId}:void 0});if(!m)throw new Error(`Failed to open ${t.socialAuth} login window`);f("connecting"),t.isLinking?await ie(h,{strategy:t.socialAuth,openedWindow:m,closeOpenedWindow:x=>{x.close()}}).catch(x=>{throw s(x.message),x}):await h.connect({chain:t.chain,strategy:t.socialAuth,openedWindow:m,closeOpenedWindow:x=>{x.close()},client:t.client}),await ne(t.socialAuth,re),f("connected"),y()}catch(m){f("error"),m instanceof Error&&((H=m==null?void 0:m.message)!=null&&H.includes("PAYMENT_METHOD_REQUIRED"))&&s(n.maxAccountsExceeded),console.error(`Error sign in with ${t.socialAuth}`,m)}},b=(w=t.state)==null?void 0:w.socialLogin,T=r.useRef(!1);return r.useEffect(()=>{T.current||b&&(T.current=!0,f("connecting"),b.connectionPromise.then(()=>{y(),f("connected")}).catch(l=>{s(l.message),f("error")}))},[y,b]),e.jsx(p,{animate:"fadein",flex:"column",fullHeight:!0,children:e.jsxs(p,{flex:"column",expand:!0,p:"lg",style:{paddingBottom:0},children:[t.goBack&&e.jsx(ye,{title:t.isLinking?t.connectLocale.manageWallet.linkProfile:i.title,onBack:t.goBack}),t.size==="compact"?e.jsx(g,{y:"xl"}):null,e.jsxs(p,{flex:"column",center:"both",expand:!0,style:{textAlign:"center",minHeight:"250px"},children:[k!=="error"&&e.jsxs(p,{animate:"fadein",children:[e.jsx(M,{color:"primaryText",center:!0,multiline:!0,style:{maxWidth:"250px"},children:i.instruction}),e.jsx(g,{y:"xl"}),e.jsx(p,{center:"x",flex:"row",children:e.jsx(le,{size:"lg",color:"accentText"})}),e.jsx(g,{y:"xxl"})]}),k==="error"&&e.jsxs(p,{animate:"fadein",children:[u?e.jsx(M,{center:!0,color:"danger",children:u}):e.jsx(M,{color:"danger",children:i.failed}),e.jsx(g,{y:"lg"}),e.jsx(Q,{variant:"primary",onClick:j,children:i.retry}),e.jsx(g,{y:"xxl"})]})]})]})})}export{Re as E,Be as L,At as O,Wt as P,Ot as S};
